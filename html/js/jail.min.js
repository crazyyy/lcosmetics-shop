!function(e,t){var i=t(jQuery),a="function"==typeof define&&define.amd;a?define(e,["jquery"],i):(this.jQuery||this.$||this)[e]=i}("jail",function(e){function t(e,t){var i=!1;!t||(i=t.data("triggerElem")),!!i&&"function"==typeof i.bind&&(i.bind(e.event,{options:e,images:t},a),s.bind("resize",{options:e,images:t},a))}function i(e){var t=0;if(0!==e.length)for(;t!==e.length;)e[t].getAttribute("data-src")?t++:e.splice(t,1)}function a(a){var o=a.data.images,l=a.data.options;o.data("poller",setTimeout(function(){if(d=e.extend({},o),i(d),e(d).each(function(){this!==window&&r(l,this,d)}),n(d))return void e(a.currentTarget).unbind(a.type);if("scroll"!==l.event){var c=/scroll/i.test(l.event)?o.data("triggerElem"):s;l.event="scroll",o.data("triggerElem",c),t(l,e(d))}},l.timeout))}function n(t){var i=!0;return e(t).each(function(){!e(this).attr("data-src")||(i=!1)}),i}function r(t,i,a){var n=e(i),r=/scroll/i.test(t.event)?a.data("triggerElem"):s,f=!0;t.loadHiddenImages||(f=c(n,r,t)&&n.is(":visible")),f&&o(r,n,t.offset)&&l(t,n)}function o(e,t,i){var a=e[0]===window,n=a?{top:0,left:0}:e.offset(),r=n.top+(a?e.scrollTop():0),o=n.left+(a?e.scrollLeft():0),l=o+e.width(),c=r+e.height(),s=t.offset(),f=t.width(),d=t.height();return r-i<=s.top+d&&c+i>=s.top&&o-i<=s.left+f&&l+i>=s.left}function l(t,a){var r=new Image;r.onload=function(){a.hide().attr("src",r.src),a.removeAttr("data-src"),t.effect?(t.speed?a[t.effect](t.speed):a[t.effect](),a.css("opacity",1),a.show()):a.show(),i(d),!t.callbackAfterEachImage||t.callbackAfterEachImage.call(this,a,t),n(d)&&!!t.callback&&!u&&(t.callback.call(e.jail,t),u=!0)},r.src=a.attr("data-src")}function c(i,a,n){for(var r=i.parent(),l=!0;r.length&&"BODY"!==r.get(0).nodeName.toUpperCase();){if("hidden"===r.css("overflow")){if(!o(r,i,n.offset)){l=!1;break}}else if("scroll"===r.css("overflow")&&!o(r,i,n.offset)){l=!1,e(d).data("triggerElem",r),n.event="scroll",t(n,e(d));break}if("hidden"===r.css("visibility")||"hidden"===i.css("visibility")){l=!1;break}if(a!==s&&r===a)break;r=r.parent()}return l}var s=e(window),f={timeout:1,effect:!1,speed:400,triggerElement:null,offset:0,event:"load",callback:null,callbackAfterEachImage:null,placeholder:!1,loadHiddenImages:!1},d=[],u=!1;return e.jail=function(t,i){var a=t||{},n=e.extend({},f,i);e.jail.prototype.init(a,n),/^(load|scroll)/.test(n.event)?e.jail.prototype.later.call(a,n):e.jail.prototype.onEvent.call(a,n)},e.jail.prototype.init=function(t,i){t.data("triggerElem",i.triggerElement?e(i.triggerElement):s),!i.placeholder||t.each(function(){e(this).attr("src",i.placeholder)})},e.jail.prototype.onEvent=function(i){var a=this;i.triggerElement?t(i,a):a.bind(i.event,{options:i,images:a},function(t){var i=e(this),a=t.data.options,n=t.data.images;d=e.extend({},n),l(a,i),e(t.currentTarget).unbind(t.type)})},e.jail.prototype.later=function(i){var a=this;setTimeout(function(){d=e.extend({},a),a.each(function(){r(i,this,a)}),i.event="scroll",t(i,a)},i.timeout)},e.fn.jail=function(t){return new e.jail(this,t),d=[],this},e.jail}),$(function(){$("img.imagejail").jail({effect:"fadeIn",speed:400,placeholder:"catalog/view/javascript/jquery/jail/grey.gif"})});
//# sourceMappingURL=maps/jail.min.js.map
